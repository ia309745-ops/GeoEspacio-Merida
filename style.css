/* --- Configuración Global --- */
html, body { height: 100%; width: 100%; margin: 0; padding: 0; font-family: 'Open Sans', sans-serif; overflow: hidden; }

/* Portada */
#landing-page { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-image: url('portada.jpg'); background-size: cover; background-position: center; z-index: 9999; display: flex; align-items: center; justify-content: center; }
.overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 35, 15, 0.85); z-index: 1; }
.landing-content { position: relative; z-index: 2; width: 90%; max-width: 800px; text-align: center; display: flex; flex-direction: column; align-items: center; }
.landing-text { color: white; }
.landing-text h1 { font-size: 3em; margin-bottom: 10px; line-height: 1.2; color: #66c2a4; }
.landing-text h2 { font-size: 1.8em; margin-top: 0; font-weight: 400; color: #e5f5e0; margin-bottom: 30px; }
.intro-text { font-size: 1.2em; line-height: 1.6; margin-bottom: 40px; opacity: 0.9; max-width: 700px; margin-left: auto; margin-right: auto; }
.city-quote { border-left: 4px solid #f39c12; padding-left: 15px; font-style: italic; margin: 20px auto; background: rgba(255,255,255,0.05); padding: 15px; border-radius: 0 8px 8px 0; max-width: 600px; text-align: left; }
.city-quote footer { display: block; margin-top: 10px; font-size: 0.8em; font-weight: bold; color: #f39c12; font-style: normal; }
#btn-comenzar { margin-top: 20px; padding: 15px 40px; font-size: 1.3em; background: #238b45; color: white; border: none; border-radius: 50px; cursor: pointer; font-weight: bold; transition: transform 0.2s, background 0.2s; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
#btn-comenzar:hover { background: #2ecc71; transform: translateY(-3px); }

/* Header */
#main-header { position: absolute; top: 0; left: 0; width: 100%; height: 60px; background: #238b45; color: white; display: flex; justify-content: space-between; align-items: center; padding: 0 20px; box-sizing: border-box; z-index: 2000; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
.brand { font-size: 1.4em; font-weight: bold; display: flex; align-items: center; gap: 10px; }
.main-nav { display: flex; gap: 5px; }
.nav-btn { background: none; border: none; color: rgba(255,255,255,0.7); padding: 10px 15px; cursor: pointer; font-weight: 600; font-size: 0.95em; border-bottom: 3px solid transparent; transition: all 0.2s; }
.nav-btn:hover { color: white; background: rgba(255,255,255,0.1); }
.nav-btn.active { color: white; border-bottom-color: #fff; }
.hamburger-container { position: relative; }
#hamburger-btn { background: none; border: 1px solid rgba(255,255,255,0.3); border-radius: 4px; color: white; font-size: 1.2em; padding: 5px 12px; cursor: pointer; }
#hamburger-btn:hover { background: rgba(255,255,255,0.2); }
#hamburger-dropdown { display: none; position: absolute; top: 100%; right: 0; margin-top: 10px; background: white; width: 200px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.2); overflow: hidden; }
#hamburger-dropdown.show { display: block; }
.menu-item { display: block; width: 100%; padding: 12px 15px; text-align: left; background: none; border: none; border-bottom: 1px solid #eee; color: #333; font-size: 0.95em; cursor: pointer; }
.menu-item:hover { background: #f9f9f9; color: #238b45; }

/* UI Layers */
#main-content { position: absolute; top: 60px; left: 0; width: 100%; height: calc(100% - 60px); pointer-events: none; }
.ui-layer { display: none; width: 100%; height: 100%; position: relative; }
.ui-layer.active { display: block; }
.ui-layer > div { pointer-events: auto; }
.placeholder-view { background: #f4f4f4; pointer-events: auto; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #777; text-align: center; }
.placeholder-view i { font-size: 5em; margin-bottom: 20px; color: #ccc; }
.placeholder-view h2 { color: #333; margin: 0 0 10px 0; }
.placeholder-view span { margin-top: 20px; padding: 5px 15px; background: #eee; border-radius: 20px; font-size: 0.85em; font-weight: bold; letter-spacing: 1px; }

/* MAPA */
#map { position: absolute; top: 60px; left: 0; width: 100%; height: calc(100% - 60px); z-index: 1; }

/* Paneles IZQUIERDOS (Info) */
#left-info-panel, #left-denue-panel { 
    position: absolute; top: 15px; left: 15px; width: 300px; 
    background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.2); 
    z-index: 1000; padding: 15px; box-sizing: border-box; 
    max-height: calc(100vh - 140px); overflow-y: auto; 
}
.leaflet-top.leaflet-left { left: 320px; top: 15px; }

/* Paneles DERECHOS */
#right-controls-panel { position: absolute; bottom: 25px; right: 15px; width: 260px; background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.2); z-index: 1000; padding: 15px; box-sizing: border-box; font-size: 0.9em; max-height: calc(100vh - 300px); overflow-y: auto; }
#global-dashboard { position: absolute; top: 15px; right: 15px; width: 260px; background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.2); z-index: 1000; padding: 15px; box-sizing: border-box; font-size: 0.9em; }
#bottom-legend { position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%); background: white; padding: 8px 15px; border-radius: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.3); z-index: 1000; display: flex; gap: 15px; align-items: center; flex-wrap: wrap; justify-content: center; }

/* Panel NOM-002 (DENUE) */
#denue-dashboard-panel {
    position: absolute; top: 15px; right: 15px; 
    width: 320px; background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.2); 
    padding: 15px; box-sizing: border-box; font-size: 0.9em; z-index: 1000;
    max-height: calc(100vh - 100px); overflow-y: auto; 
}
#denue-filters-list { margin-top: 10px; max-height: 450px; overflow-y: auto; border: 1px solid #eee; padding: 5px; border-radius: 4px; }

/* Estilos de Acordeón/Anidado DENUE */
.filter-group { margin-bottom: 5px; border-bottom: 1px solid #f9f9f9; }
.filter-header { display: flex; align-items: center; padding: 5px; cursor: pointer; background: #fff; transition: background 0.2s; }
.filter-header:hover { background: #f0f0f0; }
.toggle-icon { margin-left: auto; font-size: 0.8em; color: #999; transition: transform 0.3s; }
.toggle-icon.rotated { transform: rotate(90deg); }
.filter-children { display: none; padding-left: 25px; margin-bottom: 5px; }
.filter-children.show { display: block; }
.child-filter-item { display: flex; align-items: center; margin-bottom: 3px; font-size: 0.9em; color: #555; }

/* Generales */
h3, h4 { margin-top: 0; color: #238b45; }
.centered-title { text-align: center; margin-bottom: 15px; }
hr { border: 0; border-top: 1px solid #eee; margin: 10px 0; }
.control-group { margin-bottom: 10px; }
#opacity-slider { width: 100%; }
#btn-toggle-radii, #btn-ubicacion { width: 100%; padding: 8px; margin-top: 8px; background: #f8f9fa; border: 1px solid #ddd; border-radius: 4px; cursor: pointer; font-weight: 600; }
#category-filters { max-height: 120px; overflow-y: auto; border: 1px solid #eee; padding: 5px; }
.stat-row { display: flex; justify-content: space-between; margin-bottom: 5px; }
.stat-row.highlight { background: #e8f5e9; font-weight: bold; color: #1b5e20; padding: 5px; border-radius: 4px; }
.legend-item { display: flex; align-items: center; font-size: 0.85em; font-weight: 600; }
.legend-icon { width: 16px; height: 16px; margin-right: 6px; }
.leaflet-control-layers { border-radius: 8px !important; box-shadow: 0 2px 8px rgba(0,0,0,0.2); border: none !important; }
.leaflet-bottom.leaflet-left { bottom: 20px; left: 15px; margin-bottom: 0; }

/* Estilos Mejorados NOM-001 Dashboard (ICONOS PEQUEÑOS) */
.pob-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 5px; }
.pob-item { background: #fff; border: 1px solid #eee; border-radius: 6px; padding: 5px; text-align: center; display: flex; flex-direction: column; align-items: center; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
.pob-item i { font-size: 1.2em; color: #238b45; margin-bottom: 3px; }
.pob-item span { font-weight: bold; font-size: 1em; color: #333; }
.pob-item small { font-size: 0.75em; color: #777; }

/* Modal */
#modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 3000; display: none; justify-content: center; align-items: center; }
#modal-container { 
    background: white; 
    width: 90%; 
    max-width: 700px; 
    max-height: 80vh; /* Altura máxima fija */
    border-radius: 8px; 
    padding: 25px; 
    position: relative; 
    overflow-y: scroll; /* FORZAR barra de scroll siempre */
    -webkit-overflow-scrolling: touch; /* Scroll suave en móviles */
}
#modal-container p, #modal-container li { white-space: normal; word-wrap: break-word; }
#modal-close-btn { position: absolute; top: 10px; right: 15px; font-size: 2em; cursor: pointer; border:none; background:none; }
.modal-tab-pane { display: none; } .modal-tab-pane.active { display: block; }
#modal-container ul { list-style: none; padding-left: 0; }
#modal-container li { background: #f4f4f4; margin-bottom: 8px; border-radius: 4px; padding: 12px; transition: background 0.2s; }
#modal-container li:hover { background: #e8f5e9; }
#modal-container li a { display: block; text-decoration: none; color: #238b45; font-weight: bold; }
.contact-flex-container { 
    display: flex; 
    gap: 30px; /* Más espacio entre texto y foto */
    align-items: center; /* CENTRADO VERTICAL */
    justify-content: space-between; 
    flex-wrap: wrap; 
}
.contact-text { flex: 1; min-width: 250px; }
.contact-image-container { flex: 0 0 180px; display: flex; justify-content: center; }
.contact-img { width: 100%; height: auto; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.2); border: 3px solid white; }
.rating-stars { font-size: 1.8em; color: #ccc; cursor: pointer; margin-bottom: 15px; }
.rating-stars .fa-star.selected, .rating-stars .fa-star:hover { color: #f7d32a; }
#comment-box { width: calc(100% - 20px); border: 1px solid #ccc; border-radius: 4px; padding: 10px; margin-bottom: 10px; }
#submit-rating-btn { width: 100%; padding: 10px; background: #238b45; color: white; border: none; border-radius: 4px; font-weight: bold; cursor: pointer; }

@media (max-width: 768px) {
    .landing-text h1 { font-size: 2em; }
    #left-info-panel, #left-denue-panel { top: auto; bottom: 0; width: 100%; height: 35vh; border-radius: 15px 15px 0 0; }
    #right-controls-panel { top: 65px; width: auto; left: 10px; right: 10px; max-height: 150px; bottom: auto; }
    #denue-dashboard-panel { top: auto; bottom: 0; width: 100%; height: 45vh; left:0; border-radius: 15px 15px 0 0; }
    .leaflet-top.leaflet-left { display: none; }
    .nav-btn { font-size: 0.8em; padding: 10px 5px; }
    .contact-flex-container { flex-direction: column-reverse; align-items: center; } 
    .contact-image-container { margin-bottom: 20px; }
}